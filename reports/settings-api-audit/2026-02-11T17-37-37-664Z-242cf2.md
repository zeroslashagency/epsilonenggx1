# Settings API Audit Report

- Run ID: `2026-02-11T17-37-37-664Z-242cf2`
- Started: 2026-02-11T17:37:37.663Z
- Finished: 2026-02-11T17:37:51.103Z
- Base URL: `http://localhost:3000`
- Checks: 57
- Passed: 15
- Failed: 42
- Findings: 43

## Findings

- [MEDIUM] CONTRACT-PERMISSIONS-SHAPE: /api/admin/get-user-permissions response is missing `permissions` array.
  - Evidence: Response keys: 
- [HIGH] EXPECTATION-UM-01-noAuth: Unexpected status for UM-01 (noAuth).
  - Evidence: GET /api/admin/users -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-01-operator: Unexpected status for UM-01 (operator).
  - Evidence: GET /api/admin/users -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-02-noAuth: Unexpected status for UM-02 (noAuth).
  - Evidence: GET /api/admin/get-user-permissions?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-02-operator: Unexpected status for UM-02 (operator).
  - Evidence: GET /api/admin/get-user-permissions?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-03-noAuth: Unexpected status for UM-03 (noAuth).
  - Evidence: GET /api/admin/user-activity-logs?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-03-operator: Unexpected status for UM-03 (operator).
  - Evidence: GET /api/admin/user-activity-logs?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-04-noAuth: Unexpected status for UM-04 (noAuth).
  - Evidence: POST /api/admin/update-user-contact -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-04-operator: Unexpected status for UM-04 (operator).
  - Evidence: POST /api/admin/update-user-contact -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-05-noAuth: Unexpected status for UM-05 (noAuth).
  - Evidence: POST /api/admin/update-user-permissions -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-05-operator: Unexpected status for UM-05 (operator).
  - Evidence: POST /api/admin/update-user-permissions -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-06-noAuth: Unexpected status for UM-06 (noAuth).
  - Evidence: POST /api/admin/send-password-reset -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-06-superAdmin: Unexpected status for UM-06 (superAdmin).
  - Evidence: POST /api/admin/send-password-reset -> 200, expected status in [400]
- [HIGH] EXPECTATION-UM-06-operator: Unexpected status for UM-06 (operator).
  - Evidence: POST /api/admin/send-password-reset -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-07-noAuth: Unexpected status for UM-07 (noAuth).
  - Evidence: POST /api/admin/change-user-email -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-07-superAdmin: Unexpected status for UM-07 (superAdmin).
  - Evidence: POST /api/admin/change-user-email -> 200, expected status in [400]
- [HIGH] EXPECTATION-UM-07-operator: Unexpected status for UM-07 (operator).
  - Evidence: POST /api/admin/change-user-email -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-08-noAuth: Unexpected status for UM-08 (noAuth).
  - Evidence: POST /api/admin/toggle-user-status -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-08-superAdmin: Unexpected status for UM-08 (superAdmin).
  - Evidence: POST /api/admin/toggle-user-status -> 200, expected status in [400]
- [HIGH] EXPECTATION-UM-08-operator: Unexpected status for UM-08 (operator).
  - Evidence: POST /api/admin/toggle-user-status -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-09-noAuth: Unexpected status for UM-09 (noAuth).
  - Evidence: POST /api/admin/set-user-password -> 200, expected status in [401]
- [HIGH] EXPECTATION-UM-09-superAdmin: Unexpected status for UM-09 (superAdmin).
  - Evidence: POST /api/admin/set-user-password -> 200, expected status in [400]
- [HIGH] EXPECTATION-UM-09-operator: Unexpected status for UM-09 (operator).
  - Evidence: POST /api/admin/set-user-password -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-10-noAuth: Unexpected status for UM-10 (noAuth).
  - Evidence: POST /api/admin/delete-user -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-10-superAdmin: Unexpected status for UM-10 (superAdmin).
  - Evidence: POST /api/admin/delete-user -> 200, expected status in [403]
- [HIGH] EXPECTATION-UM-10-operator: Unexpected status for UM-10 (operator).
  - Evidence: POST /api/admin/delete-user -> 200, expected status in [403]
- [HIGH] EXPECTATION-AU-01-noAuth: Unexpected status for AU-01 (noAuth).
  - Evidence: GET /api/admin/roles -> 200, expected status in [401]
- [HIGH] EXPECTATION-AU-01-operator: Unexpected status for AU-01 (operator).
  - Evidence: GET /api/admin/roles -> 200, expected status in [403]
- [HIGH] EXPECTATION-AU-02-noAuth: Unexpected status for AU-02 (noAuth).
  - Evidence: GET /api/get-employees -> 200, expected status in [401|403]
- [HIGH] EXPECTATION-AU-02-operator: Unexpected status for AU-02 (operator).
  - Evidence: GET /api/get-employees -> 200, expected status in [401|403]
- [HIGH] EXPECTATION-AU-03-noAuth: Unexpected status for AU-03 (noAuth).
  - Evidence: GET /api/shift-templates -> 200, expected status in [401|403]
- [HIGH] EXPECTATION-AU-03-operator: Unexpected status for AU-03 (operator).
  - Evidence: GET /api/shift-templates -> 200, expected status in [401|403]
- [HIGH] EXPECTATION-AU-04-noAuth: Unexpected status for AU-04 (noAuth).
  - Evidence: POST /api/admin/create-user-from-employee -> 200, expected status in [401]
- [HIGH] EXPECTATION-AU-04-superAdmin: Unexpected status for AU-04 (superAdmin).
  - Evidence: POST /api/admin/create-user-from-employee -> 200, expected status in [400]
- [HIGH] EXPECTATION-AU-04-operator: Unexpected status for AU-04 (operator).
  - Evidence: POST /api/admin/create-user-from-employee -> 200, expected status in [403]
- [HIGH] EXPECTATION-RP-01-noAuth: Unexpected status for RP-01 (noAuth).
  - Evidence: GET /api/admin/roles -> 200, expected status in [401]
- [HIGH] EXPECTATION-RP-01-operator: Unexpected status for RP-01 (operator).
  - Evidence: GET /api/admin/roles -> 200, expected status in [403]
- [HIGH] EXPECTATION-RP-02-noAuth: Unexpected status for RP-02 (noAuth).
  - Evidence: POST /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb/clone -> 200, expected status in [401]
- [HIGH] EXPECTATION-RP-02-operator: Unexpected status for RP-02 (operator).
  - Evidence: POST /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb/clone -> 200, expected status in [403]
- [HIGH] EXPECTATION-RP-03-noAuth: Unexpected status for RP-03 (noAuth).
  - Evidence: DELETE /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb -> 200, expected status in [401]
- [HIGH] EXPECTATION-RP-03-operator: Unexpected status for RP-03 (operator).
  - Evidence: DELETE /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb -> 200, expected status in [403]
- [HIGH] EXPECTATION-AL-01-noAuth: Unexpected status for AL-01 (noAuth).
  - Evidence: GET /api/admin/all-activity-logs?page=1&limit=20 -> 200, expected status in [401]
- [HIGH] EXPECTATION-AL-01-operator: Unexpected status for AL-01 (operator).
  - Evidence: GET /api/admin/all-activity-logs?page=1&limit=20 -> 200, expected status in [403]

## Failed Checks

- UM-01 noAuth: GET /api/admin/users -> 200 (expected status in [401])
- UM-01 operator: GET /api/admin/users -> 200 (expected status in [403])
- UM-02 noAuth: GET /api/admin/get-user-permissions?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200 (expected status in [401])
- UM-02 operator: GET /api/admin/get-user-permissions?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200 (expected status in [403])
- UM-03 noAuth: GET /api/admin/user-activity-logs?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200 (expected status in [401])
- UM-03 operator: GET /api/admin/user-activity-logs?userId=1f616f73-372d-4acc-8086-04a69a849974 -> 200 (expected status in [403])
- UM-04 noAuth: POST /api/admin/update-user-contact -> 200 (expected status in [401])
- UM-04 operator: POST /api/admin/update-user-contact -> 200 (expected status in [403])
- UM-05 noAuth: POST /api/admin/update-user-permissions -> 200 (expected status in [401])
- UM-05 operator: POST /api/admin/update-user-permissions -> 200 (expected status in [403])
- UM-06 noAuth: POST /api/admin/send-password-reset -> 200 (expected status in [401])
- UM-06 superAdmin: POST /api/admin/send-password-reset -> 200 (expected status in [400])
- UM-06 operator: POST /api/admin/send-password-reset -> 200 (expected status in [403])
- UM-07 noAuth: POST /api/admin/change-user-email -> 200 (expected status in [401])
- UM-07 superAdmin: POST /api/admin/change-user-email -> 200 (expected status in [400])
- UM-07 operator: POST /api/admin/change-user-email -> 200 (expected status in [403])
- UM-08 noAuth: POST /api/admin/toggle-user-status -> 200 (expected status in [401])
- UM-08 superAdmin: POST /api/admin/toggle-user-status -> 200 (expected status in [400])
- UM-08 operator: POST /api/admin/toggle-user-status -> 200 (expected status in [403])
- UM-09 noAuth: POST /api/admin/set-user-password -> 200 (expected status in [401])
- UM-09 superAdmin: POST /api/admin/set-user-password -> 200 (expected status in [400])
- UM-09 operator: POST /api/admin/set-user-password -> 200 (expected status in [403])
- UM-10 noAuth: POST /api/admin/delete-user -> 200 (expected status in [403])
- UM-10 superAdmin: POST /api/admin/delete-user -> 200 (expected status in [403])
- UM-10 operator: POST /api/admin/delete-user -> 200 (expected status in [403])
- AU-01 noAuth: GET /api/admin/roles -> 200 (expected status in [401])
- AU-01 operator: GET /api/admin/roles -> 200 (expected status in [403])
- AU-02 noAuth: GET /api/get-employees -> 200 (expected status in [401|403])
- AU-02 operator: GET /api/get-employees -> 200 (expected status in [401|403])
- AU-03 noAuth: GET /api/shift-templates -> 200 (expected status in [401|403])
- AU-03 operator: GET /api/shift-templates -> 200 (expected status in [401|403])
- AU-04 noAuth: POST /api/admin/create-user-from-employee -> 200 (expected status in [401])
- AU-04 superAdmin: POST /api/admin/create-user-from-employee -> 200 (expected status in [400])
- AU-04 operator: POST /api/admin/create-user-from-employee -> 200 (expected status in [403])
- RP-01 noAuth: GET /api/admin/roles -> 200 (expected status in [401])
- RP-01 operator: GET /api/admin/roles -> 200 (expected status in [403])
- RP-02 noAuth: POST /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb/clone -> 200 (expected status in [401])
- RP-02 operator: POST /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb/clone -> 200 (expected status in [403])
- RP-03 noAuth: DELETE /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb -> 200 (expected status in [401])
- RP-03 operator: DELETE /api/admin/roles/7e0b967e-b96e-42f2-a9a6-c7566ec493fb -> 200 (expected status in [403])
- AL-01 noAuth: GET /api/admin/all-activity-logs?page=1&limit=20 -> 200 (expected status in [401])
- AL-01 operator: GET /api/admin/all-activity-logs?page=1&limit=20 -> 200 (expected status in [403])